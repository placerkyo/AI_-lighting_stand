# AIによる顔判別システムを有したライトスタンド
このリポジトリは，学部3年次に「創造性開発セミナー」という講義において，AIを用いたライトスタンドを作成した時に用いたコードと発表動画が入っている．

「創造性開発セミナー」では，分野の異なる6人でグループを組み，Raspberry Piなどを用いてAIの機能が備わっている勉強用ライトスタンドを作成するという課題が与えられる．

私は．主にAIの機能をはじめとするソフトウェアと発表動画の編集を担当した．


## 発表資料・設計書
- 発表に用いた動画は，'/video/video_A.mp4'に置いた．動画編集はShotcutというビデオ編集ソフトウェアを用いており，その際のプロジェクトファイルを'/video/movie8.mlt'に置いた．
- 講義の最初に作成した計画書を，'③商品企画書_A班.pptx'に置いた．
- 自分が担当した機能を説明したレポートを，'機能設計書_A班_所京太朗.pdf'に置いた．



## AI機能説明
本ライトスタンドは設置されたカメラ映像を用いて，以下の3つの機能を実行する．

### 1. 照明の自動点灯
OpenCVの顔検出モデルを用いて，人がいる場合はライトを点灯，いない場合はライトを消灯させる．この機能により，ライト点灯・消灯の手間が省け，さらに消し忘れによる電気の浪費を抑えることができる．

### 2. 照明の方向調整
自作した顔検出モデルを用いて，使用者の顔の方向（左，正面，右）を検出し，その方向に合わせてライトの向きを変える．ライトの向きを変えるためにモータの制御も行う．この機能により，ライトの向きを変更する手間が省ける．

### 3. 人物によるBGMの変更
自作した顔検出モデルを用いて，各使用者が事前に設定した音楽を自動で流れるようにする．これにより，複数人で一つのライトスタンドを利用している場合でも，それぞれに合った勉強環境を作ることができる．

## 顔検出モデルの作成
上述のAI機能2・3では顔検出モデルが必要になる．精度を高めるために深層学習モデルによって実現した．深層学習モデルを作成するにあたり，訓練データの作成・モデルの構築・モデルの学習を行った．

### 訓練データ作成
班員5人の顔画像を用いた．顔画像は1人あたり90秒の動画を撮り，2,250枚の画像を得た．そのうち，データとして適切でない（顔がしっかり写っていない）画像を除き，約1,500枚を訓練データとした．これらは，顔の向き（2. 照明の方向調整を学習用）と顔の人物の名前（3. 人物によるBGMの変更）の2種類のラベルを持つ．データは'CNN/data/'に'機能設計書_A班_所京太朗.pdf'を基に入れる．

### モデルの構築
モデルはResNetを参考に構築した．構築にはPytorchを用い，学習はgoogle colab上でGPUを利用し行った．学習の結果，顔の方向検出も，顔の人物検出もaccuracyが97%を超えた．モデルのコードは，顔の方向検出モデルが'CNN/Identification_dir.ipynb'に，人物検出のモデルは'CNN/Identification_persons.ipynb'にある．

## 実行方法
- ライトスタンドを組み立てる
- このリポジトリのコードを'機能設計書_A班_所京太朗.pdf'を基に置く．
- 以下のコマンドをRaspberry Piで実行する
```
python main/main.py
```
